# Cron Wizard + Chat CTA Design (YAgent)

## Цель
Сделать настройку cron-задач понятной для обычного пользователя через пошаговый мастер в UI, при этом сохранить гибкий путь через чат с агентом.

## Принятые решения
- Основной UX: пошаговый мастер во вкладке `Планировщик`.
- Режим v1: только «человеческие» сценарии расписания (без ручного cron ввода).
- Гибрид: под мастером явная сноска, что задачу можно настроить и через чат.
- Результат задач по умолчанию: в основную сессию (`sessionTarget=main`).
- Telegram onboarding-подсказка: не вторым авто-сообщением, а CTA в чате под первым приветствием.

## UX (v1)
### Планировщик
Мастер из шагов:
1. Что создать: `Напоминание` / `Автособытие`.
2. Когда:
- `Через N минут/часов`
- `Каждый день в HH:MM`
- `По дням недели + HH:MM`
3. Текст сообщения/события.
4. Подтверждение и создание.

Под мастером:
- Сноска: «Можно и проще: напишите в чат, и агент сам настроит напоминание/автособытие».
- Кнопка: `Сформулировать в чате` (подставляет шаблон, не отправляет автоматически).

### Чат
Под первым приветствием (если Telegram не подключен):
- `Подключить Telegram`
- `Сформулировать в чате`
- `Позже`

Без автоспама вторым сообщением.

## Архитектура
- Gateway API не меняем: используем текущие `cron.add`, `cron.list`, `cron.status`.
- Добавляем фронтовый state/mapper для мастера.
- Старую форму cron сохраняем как `Расширенный режим`.

## Data Flow
1. Пользователь проходит шаги мастера.
2. UI валидирует ввод.
3. Mapper переводит шаги в payload для `cron.add`.
4. После успеха: `loadCronJobs` + `loadCronStatus`, отображение в списке.

## Маппинг расписаний
- `Через N минут/часов` -> `schedule.kind="at"` (one-shot, now + N).
- `Каждый день HH:MM` -> `schedule.kind="cron"`, expr=`MM HH * * *`, `tz=local`.
- `Дни недели + HH:MM` -> `schedule.kind="cron"`, expr=`MM HH * * d1,d2...`, `tz=local`.

## Ошибки и ограничения
- Невалидные вводы показываются прямо на шаге мастера.
- Дублирование расписаний не блокируется в v1 (оставляем на будущее).
- `Расширенный режим` остается для edge-cases.

## Нефункциональные требования
- Тексты полностью на русском.
- Без изменений backend-протокола.
- Сохранение существующей совместимости со старой формой.
